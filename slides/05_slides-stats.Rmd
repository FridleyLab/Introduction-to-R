---
title: "Lea.orange[R]ning about Statistics -YEAH!!!"
subtitle: "STATISTICAL TESTS! "
author: 
  - Zachary Thompson 
institute: "Moffitt Cancer Center"
date: '`r strftime(Sys.time(), "%B %d, %Y")`'
output:
  xaringan::moon_reader:
    lib_dir: libs
    chakra: libs/remark-0.14.0.min.js
    css: 
      - css/moffitt-xaringan.css
      - css/moffitt-xaringan-extra.css
      - css/tachyons.moffitt.css
    seal: false
    nature:
      titleSlideClass: ["bottom", "left"]
      slideNumberFormat: "%current%"
      highlightStyle: atom-one-light
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE, 
  hiline = TRUE
)
options(width = 70)

#Load data...
  #load(file = "Z:/Projects/Fridley_Brooke/2813_R_Programming_Course_2020/data/alldata.RData")
   load(file = "Z:/Projects/Fridley_Brooke/2813_R_Programming_Course_2020/data/Rclassdata.RData")
  
  library(easystats)
  library(tidyverse)
  library(kableExtra)
   library(ggplot2)
  
```

name: title
class: left bottom hide-count

<!-- Slide Extras -->

```{r xaringan-extras, echo=FALSE, results="asis"}
# remotes::install_github("gadenbuie/xaringanExtra")
xaringanExtra::use_xaringan_extra(c(
  "tile_view"
  # "editable",
  # "animate",
  # "panelset"
))
```

<!-- Title Slide -->
<!-- <div class="talk-logo"></div> -->

.talk-meta[
.talk-title[
# `r rmarkdown::metadata$title`

`r rmarkdown::metadata$subtitle`
]

.talk-author[
`r paste(rmarkdown::metadata$author, collapse = " &middot; ")`<br>
.moffitt-gray[`r paste(rmarkdown::metadata$institute, collapse = ", ")`]
]

.talk-date.moffitt-gray[
`r knitr::knit(text = rmarkdown::metadata$date)`
]
]


```{css echo=FALSE}
/* Define title slide image or logo here */
.talk-logo {
  width: 400px;
  height: 750px;
  position: absolute;
  top: 6%;
  right: 7%;
  /* background-image: url('img/r4ds-cover.png'); */
  background-size: contain;
  background-repeat: no-repeat;
  background-position: contain;
}
```

<!-- Moffitt Logo and Slide Border ----

All slides except "title" and "inverse" slides
have the Moffitt Color Bar and logo.

Additional classes are provided to disable both:

- `class: no-logo` hides the logo
- `class: no-border` hides the border

or to force either to be shown

- `class: moffitt-slide-logo` shows the logo
- `class: moffitt-slide-border` shows the border
-->

---

## What you will learn about
 
 
[Link to another page](another-page).
 
 
.w-half[

- Chi square and Fisher’s test

- Correlations

- Two-sample tests (t-test, wilcoxon test, anova [for more than 2 groups])

]

---

## Review of tables
 

```{r comment=NA}

 table(Rclassdata$radiation_therapy, Rclassdata$vital_status, 
       useNA = "always") 
   
```
 
 
---

## Review of tables
 

```{r comment=NA}

table(Rclassdata$radiation_therapy, Rclassdata$vital_status) 
   
```

 
---


# Pearson’s chi-squared test
 
The chi squared test is a non-parametric test that can be applied to contingency tables with various dimensions. The name of the test originates from the chi-squared distribution, which is the distribution for the squares of independent standard normal variables. This is the distribution of the test statistic of the chi squared test, which is defined by the sum of chi-square values x2i,j for all pairs of cells arising from the difference between a cell’s observed value and the expected value, normalized by the expected value.
 
$\chi ^{2}$ = $\sum$ $\frac{(O_{i} - E_{i})^{2}}{E_{i}}$ 


*   $\chi ^{2}$ = chi square statistic
*   $O_{i}$ = observed value
*   $E_{i}$ = expected value




---


## Pearson’s chi-squared test
 
The null hypothesis of the Chi-Square test is that no relationship exists on the categorical variables in the population; they are independent.

```{r comment=NA}

  chisq.test(
    table(Rclassdata$radiation_therapy, Rclassdata$vital_status )
    )
```


---

## Pearson’s chi-squared test
 
 
```{r comment=NA}

 
table(Rclassdata$smoking,Rclassdata$radiation_therapy)
```

---

## Pearson’s chi-squared test
 
 
```{r comment=NA}

 
chisq.test(
  table(Rclassdata$smoking,Rclassdata$radiation_therapy)
  )
```
 
 
 
---



## Fisher’s exact test
 
Fisher's exact test is practically applied only in analysis of small samples but actually it is valid for all sample sizes. While the chi-squared test relies on an approximation, Fisher's exact test is one of exact tests. Especially when more than 20% of cells have expected frequencies < 5, we need to use Fisher's exact test because applying approximation method is inadequate. Fisher's exact test assesses the null hypothesis of independence applying hypergeometric distribution of the numbers in the cells of the table. Many packages provide the results of Fisher's exact test for 2 × 2 contingency tables 
 
---
 

##  Fisher’s exact test
 

```{r comment=NA}
 table(Rclassdata$radiation_therapy, Rclassdata$vital_status )

```


---


##  Fisher’s exact test
 

```{r comment=NA}
fisher.test(
    table(Rclassdata$radiation_therapy, Rclassdata$vital_status )  )
```
 
 
---
 
# Correlation 
 
A correlation coefficient is a numerical measure of some type of correlation, meaning a statistical relationship between two variables.  

Several types of correlation coefficient exist, each with their own definition and own range of usability and characteristics. They all assume values in the range from −1 to +1, where ±1 indicates the strongest possible agreement and 0 no disagreement.

The .bg-orange.white[Pearson product-moment correlation coefficient], also known as r or Pearson's r, is a measure of the strength and direction of the linear relationship between two variables that is defined as the covariance of the variables divided by the product of their standard deviations.  Pearson's r is the best-known and most commonly used type of correlation coefficient.  
 

---
 
## Correlation 
 

```{r  comment=NA}

Rclassdata$log_DUOXA1_exp <- log(Rclassdata$DUOXA1_exp+1)
Rclassdata$log_DUOX1_exp <- log(Rclassdata$DUOX1_exp+1)
Rclassdata$log_BUB1_exp <- log(Rclassdata$BUB1_exp+1)
Rclassdata$log_C10orf32_exp <- log(Rclassdata$C10orf32_exp+1)

r1<-Rclassdata %>% correlation::cor_test("DUOXA1_exp", 
                                          "DUOX1_exp", 
                                          method = c("pearson") )

r2<-Rclassdata %>% correlation::cor_test("log_DUOXA1_exp",
                                          "log_DUOX1_exp",
                                          method = c("pearson") )
 
r3<-Rclassdata %>% correlation::cor_test("BUB1_exp",
                                          "C10orf32_exp",
                                          method = c("pearson") )
r4<-Rclassdata %>% correlation::cor_test("log_BUB1_exp",
                                          "log_C10orf32_exp",
                                          method = c("pearson") )
 
 
r5<-Rclassdata %>% correlation::cor_test("AAMP_exp",
                                          "A1CF_exp",
                                          method = c("pearson") )
 
 
```
---
 
## Correlation 
 

```{r comment=NA}
 knitr::kable(bind_rows(r1,r2,r3,r4,r5), format = 'html') %>%
  kable_styling(font_size = 12)

```

---

```{r  comment=NA}

ggplot(Rclassdata) + aes(DUOXA1_exp,  DUOX1_exp ) + geom_point() + 
         annotate(geom="text", x=10, y=25000, label=paste("r = ",round(r1$r,2), sep=""),  color="red")

```

---

```{r  comment=NA}

ggplot(Rclassdata) + aes(BUB1_exp,  C10orf32_exp ) + geom_point()+ 
         annotate(geom="text", x=1000, y=4000, label=paste("r = ",round(r3$r,2), sep=""),  color="red")

```
---

```{r  comment=NA}

ggplot(Rclassdata) + aes(log(BUB1_exp),  log(C10orf32_exp) ) + geom_point() + 
         annotate(geom="text", x=0, y=8, label=paste("r = ",round(r3$r,2), sep=""),  color="red")

```

---

```{r  comment=NA}

ggplot(Rclassdata) + aes(AAMP_exp,  A1CF_exp ) + geom_point() + 
         annotate(geom="text", x=0, y=4000, label=paste("r = ",round(r5$r,2), sep=""),  color="red")

```

 

---

# Two sample tests

---

## Wilcoxon test 

The Wilcoxon signed-rank test is a non-parametric statistical hypothesis test used to compare two related samples, matched samples, or repeated measurements on a single sample to assess whether their population mean ranks differ (i.e. it is a paired difference test). It can be used as an alternative to the paired Student's t-test (also known as "t-test for matched pairs" or "t-test for dependent samples") when the distribution of the difference between two samples' means cannot be assumed to be normally distributed.  A Wilcoxon signed-rank test is a nonparametric test that can be used to determine whether two dependent samples were selected from populations having the same distribution.

---

## Wilcoxon test 
```{r comment=NA}
wilcox.test(Rclassdata$BUB1_exp, y = Rclassdata$A1CF_exp,
            alternative = c("two.sided" ) )

 
```

---

## T-tests
 
A t-test is a method used to determine if there 
is a significant difference between the means 
of two groups based on a sample of data.

The test relies on a set of assumptions for it
to be interpreted properly and with validity.
Among these assumptions, the data must be randomly
sampled from the population of interest and 
that the data variables follow a normal
distribution.

---

## T-test
```{r comment=NA}

t.test( Rclassdata$BUB1_exp, y = Rclassdata$A1CF_exp, 
        alternative = c("two.sided"))
 
```

---

## T-test

Fun Fact  The t-test was developed by a chemist
working for the Guinness brewing company as a 
simple way to measure the consistent quality of
stout.  It was further developed and adapted,
and now refers to any test of a statistical
hypothesis in which the statistic being tested
for is expected to correspond to a t-distribution
if the null hypothesis is supported. 

--- 

     
---
 
## Typography

Text can be **bold**, _italic_, or ~~strikethrough~~.

[Link to another page](another-page).

There should be whitespace between paragraphs.

There should be whitespace between paragraphs. We recommend including a README, or a file with information about your project.

---

.flex[
.w-third[
#### Foreground Colors

- .blue[blue]

- .blue-medium[blue-medium]

- .blue-light[blue-light]

- .green[green]

- .yellow[yellow]

- .orange[orange]

- .pink[pink]

- .red[red]

- .moffitt-gray[moffitt-gray]
]

.w-third[
#### Background Colors

- .bg-blue.white[blue]

- .bg-blue-medium[blue-medium]

- .bg-blue-light[blue-light]

- .bg-green[green]

- .bg-yellow[yellow]

- .bg-orange.white[orange]

- .bg-pink[pink]

- .bg-red.white[red]

- .bg-moffitt-gray[moffitt-gray]
]

.w-third[
#### Color Classes

- Foreground  
  `.blue[...]`
  
- Background  
  `.bg-blue[...]`
]
]

---

# Big Topic or Inverse Slides `#`

## Slide Headings `##`

### Sub-slide Headings `###`

#### Bold Call-Out `####`

This is a normal paragraph text. Only use header levels 1-4.

##### Possible, but not recommended `#####`

###### Definitely don't use h6 `######`

---
class: inverse center middle

# Topic Changing Interstitial

--

```
class: inverse center middle
```

---
layout: true

## Slide Classes

---
class: no-logo

This slide doesn't have a logo.

```
---
class: no-logo

This slide doesn't have a logo.
```

---
class: no-border

This slide doesn't have a bottom border.

```
---
class: no-border

This slide doesn't have a bottom border.
```

---
class: hide-count

This slide doesn't have a slide count.

```
---
class: hide-count

This slide doesn't doesn't have a slide count.
```

---
layout: true

## Blocks

---

### Blockquote

> This is a blockquote following a header.
>
> When something is important enough, you do it even if the odds are not in your favor.

---

### Code Blocks

#### R Code

```{r eval=FALSE}
ggplot(gapminder) +
  aes(x = gdpPercap, y = lifeExp, size = pop, color = country) +
  geom_point() +
  facet_wrap(~year)
```

#### JavaScript

```js
var fun = function lang(l) {
  dateformat.i18n = require('./lang/' + l)
  return true;
}
```

---

### More R Code

```{r}
library(dplyr)
dplyr::starwars %>% dplyr::slice_sample(n = 4)
```

---

```{r message=TRUE}
cli::cli_alert_success("It worked!")
```

--

```{r message=TRUE}
message("Just a friendly message")
```

--

```{r warning=TRUE}
warning("This could be bad...")
```

--

```{r error=TRUE}
stop("I hope you're sitting down for this")
```


---
layout: true

## Tables

---

```{r}
tibble::as_tibble(mtcars)
```

---

```{r}
knitr::kable(head(mtcars), format = 'html')
```

---

```{r}
DT::datatable(head(mtcars), fillContainer = FALSE, options = list(pageLength = 4))
```


---

A demo table using [gt](https://gt.rstudio.com/), prepared here and shown in the next two slides.

```{r}
library(gt) #<<
library(tidyr)

gt_table <- mtcars %>%
  tibble::rownames_to_column("car") %>%
  separate(car, c("make", "model"), sep = " ", extra = "merge") %>% 
  group_by(make) %>%
  filter(n() > 1) %>%
  slice(1:2) %>%
  gt() %>%  #<<
  tab_header(title = "Data About Cars")
```

---

.flex[
.w-20.mr3[
```{r gt_table1, eval=FALSE}
gt_table
```
]
.w-80[
```{r ref.label="gt_table1", echo=FALSE}
```
]
]


---

.flex[
.w-40.mr3[
```{r gt_table2, eval=FALSE}
as_raw_html(gt_table)
```
]
.w-60[
```{r ref.label="gt_table2", echo=FALSE}
```
]
]

---
layout: true

## Lists

---

.pull-left[
#### Here is an unordered list:

*   Item foo
*   Item bar
*   Item baz
*   Item zip
]

.pull-right[

#### And an ordered list:

1.  Item one
1.  Item two
1.  Item three
1.  Item four
]

---

### And a nested list:

- level 1 item
  - level 2 item
  - level 2 item
    - level 3 item
    - level 3 item
- level 1 item
  - level 2 item
  - level 2 item
  - level 2 item
- level 1 item
  - level 2 item
  - level 2 item
- level 1 item

---

### Nesting an ol in ul in an ol

- level 1 item (ul)
  1. level 2 item (ol)
  1. level 2 item (ol)
    - level 3 item (ul)
    - level 3 item (ul)
- level 1 item (ul)
  1. level 2 item (ol)
  1. level 2 item (ol)
    - level 3 item (ul)
    - level 3 item (ul)
  1. level 4 item (ol)
  1. level 4 item (ol)
    - level 3 item (ul)
    - level 3 item (ul)
- level 1 item (ul)

---
layout: false

## Plots

```{r plot-example}
library(ggplot2)
ggplot(mpg) + aes(hwy, cty, color = class) + geom_point()
```

---

## Custom plot theme

If [moffittdocs](https://github.com/Moffitt-Health-Informatics/moffittdocs) is available...

```{r}
plot_theme <- if (requireNamespace("moffittdocs", quietly = TRUE)) {
  moffittdocs::theme_moffitt() + theme(plot.margin = margin())
} else {
  theme_minimal()
}
```

---

## Custom plot theme

```{r plot-example-themed}
g <- ggplot(mpg) + aes(hwy, cty, color = class) + geom_point()
g + plot_theme
```

---

## Square image

.w-50.center[
![](https://octodex.github.com/images/labtocat.png)
]

.footnote[Uses `.w-50[...]`]

---

### Wide image

![](https://guides.github.com/activities/hello-world/branching.png)

.footnote[Wide images scale to 100% slide width]

---

## Two images

.pull-left[
![](https://octodex.github.com/images/motherhubbertocat.png)
]

.pull-right[
![](https://octodex.github.com/images/dinotocat.png)
]

---

### Definition lists can be used with HTML syntax.

<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>

---
class: inverse center middle

# Slide Extras

---

## Includes xaringanExtra

Uncomment the extensions in the `xaringan-extras` chunk to enable.

```{r eval=FALSE}
xaringanExtra::use_xaringan_extra(c(
  "tile_view"
  # "editable",
  # "animate",
  # "panelset"
))
```

Press <kbd>O</kbd> to open Tile .b[O]verview.

[gadenbuie/xaringanExtra](https://github.com/gadenbuie/xaringanExtra)